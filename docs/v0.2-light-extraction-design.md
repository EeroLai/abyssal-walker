# Abyssal Walker - v0.2 輕度搜打撤化改版設計（Draft）

## 文件資訊
- 版本：v0.2-draft
- 日期：2026-02-25
- 目標：保留刷寶與組流派核心，引入搜打撤的風險決策張力
- 範圍：單人模式、現有主循環延伸，不重做核心戰鬥系統

## 1. 設計目標
1. 保留核心：刷寶、掉裝、Crafting、寶石連結、模組組合。
2. 提升張力：讓「繼續推層 or 撤離結算」成為有代價決策。
3. 明確回報：高風險直接提升裝備詞綴品質與鍛造價值，不只增加掉落數量。
4. 失敗可承受：死亡有損失，但不至於整場白打。

## 2. 版本定位（Light Extraction）
本版本不是硬核搜打撤。只抽取三個精華：
1. 有風險的深入決策。
2. 有記憶點的帶出回報。
3. 成功/失敗都有進度（只是效率不同）。

不採用項目：
1. 全掉光懲罰。
2. 擬真生存子系統（飢餓、斷肢、醫療微操）。
3. 強制多人對抗元素。

## 3. 新核心循環
1. 進入深淵並開始推層，累積風險值 `RiskScore`。
2. 每層戰鬥與事件提高風險，同時提升掉落品質上限。
3. 在撤離窗口到來時，玩家選擇：
   - 撤離：結算本趟收益，安全帶出大部分戰利品。
   - 繼續：承擔更高風險，追求更高品質裝備與高階通貨。
4. 死亡時失去高價值戰利品，但保留部分基礎收益。
5. 帶出資源回到基地，進行裝備鍛造與下趟配置。

## 4. 系統設計

### 4.1 風險值（RiskScore）
來源：
- 通關樓層：`+10`
- 擊殺菁英：`+8`
- 完成高風險事件：`+12`
- 進入 Boss 層並擊殺：`+20`

效果：
- 影響詞綴 tier 權重。
- 解鎖高階掉落池（稀有通貨、特殊詞綴池）。
- 提高敵人威脅（生命、傷害、詞綴數量）。

### 4.2 撤離窗口
規則：
- 非隨時可撤，於固定節點開啟（例：每 3 層一次）。
- 撤離窗口有短時間限制（例：20 秒內決定）。
- 未在窗口決定則視為繼續挑戰。

設計意圖：
- 讓玩家在資訊不完全下做「保本 / 加碼」決策。

### 4.3 掉落與裝備回報
核心原則：高風險提高品質上限，而非單純掉更多。

掉落結構（初版建議）：
- 70%：通貨/材料
- 30%：可穿裝備

Risk 對裝備品質：
- `RiskScore` 提高高 tier 詞綴抽中率。
- `RiskScore` 高於門檻時開啟特殊詞綴池。
- 菁英/Boss 掉落受 Risk 加成倍率更高。

### 4.4 通貨擴充（由 3 種擴到 7 種）
現有：`alter`, `augment`, `refine`
新增：
1. `seal_rune`：鎖定 1 條詞綴再重鑄。
2. `purge_acid`：刪除 1 條指定詞綴。
3. `infuse_sigil`：提高特定流派標籤詞綴權重。
4. `abyss_catalyst`：高風險腐化（大幅強化或負面結果）。

設計意圖：
- 提供「修壞裝」與「定向追流派」能力。
- 讓高風險通貨形成明確目標。

### 4.5 死亡與保留
死亡結算（初版）：
- 保留基礎通貨的 `40%`。
- 失去本趟高價值戰利品（高階通貨、未保險稀有品）。
- 若有保險機制，可保留 1 件指定物件。

設計意圖：
- 保留風險痛感。
- 避免玩家「一死全白打」直接流失。

### 4.6 成長壓力控制（避免越玩越無腦碾壓）
1. 敵方強度隨 Risk 超線性成長。
2. 高階收益綁定高風險層段，不在低層大量產出。
3. 透過事件詞綴加入限制（例：禁療、減移速、異常抗性）。

## 5. 與現有架構對應

### 5.1 主要改動檔案（預計）
- `scripts/autoload/GameManager.gd`
  - 新增 Risk 狀態、撤離狀態、結算函式。
- `scripts/main/Game.gd`
  - 接入撤離窗口流程、死亡結算分支。
- `scripts/core/loot/*`
  - 實作 Risk 影響掉落品質與通貨池。
- `data/abyss/floors.json`
  - 新增撤離窗口節點或節點規則。
- `data/crafting/*.json`（或現有 crafting 資料）
  - 新增通貨定義與效果參數。
- `scripts/ui/HUD.gd`
  - 顯示 Risk、撤離窗口提示、當前倍率。
- `scripts/ui/CraftingPanel.gd`
  - 新通貨操作與說明。

### 5.2 新增事件（EventBus）
- `risk_score_changed(new_value)`
- `extraction_window_opened(floor, timeout_sec)`
- `extraction_window_closed()`
- `run_extracted(summary)`
- `run_failed(summary)`

## 6. 平衡初始參數（可調）
- 風險基礎增長：每層 `+10`
- 撤離窗口：每 `3` 層
- 死亡保留：基礎通貨 `40%`
- 裝備品質加成：Risk 每 `25` 提升一級權重段
- 高階池解鎖：Risk `>= 80`

## 7. 成功指標（內部測試）
1. 玩家平均每局至少出現 2 次撤離抉擇。
2. 70% 以上測試局有「繼續賭或撤離」明顯情緒波動。
3. 失敗局仍能完成至少 1 次有效鍛造。
4. 玩家可口述「這件裝是因為我冒了某個險拿到的」。

## 8. 風險與對策
1. 風險：玩家感覺懲罰太重。
   - 對策：提高保底保留比例或提供首死保護。
2. 風險：通貨種類增加後操作複雜。
   - 對策：分版本開放（先 6 種，後上 `abyss_catalyst`）。
3. 風險：低層刷保守路線最優。
   - 對策：高階通貨與高詞綴池只在中高 Risk 開啟。

## 9. 版本切分建議
- v0.2.0
  - RiskScore
  - 撤離窗口
  - 死亡部分保留
  - Risk 影響詞綴品質
- v0.2.1
  - 新增 `seal_rune`, `purge_acid`, `infuse_sigil`
  - UI 完整提示
- v0.2.2
  - `abyss_catalyst`
  - 保險機制
  - 高風險事件池擴充
